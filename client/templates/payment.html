{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link rel="stylesheet" href="{% static 'css/payment.css' %}">

<div style="background: #2874f0; color: white; padding: 15px 10%; display: flex; align-items: center; gap: 10px;">
    <h3 style="margin: 0;">Complete Payment</h3>
    <span style="font-size: 12px; background: #fff; color: #2874f0; padding: 2px 5px; border-radius: 2px; font-weight: bold;">100% Secure</span>
</div>

<div class="payment-container">
    
    <div class="left-section">
        
        <div class="payment-sidebar">
            <div class="payment-option active" onclick="showMethod('upi', this)">
                <i class="fa fa-google-wallet"></i> UPI
            </div>
            <div class="payment-option" onclick="showMethod('card', this)">
                <i class="fa fa-credit-card"></i> Credit / Debit / ATM Card
            </div>
            <div class="payment-option" onclick="showMethod('netbanking', this)">
                <i class="fa fa-university"></i> Net Banking
            </div>
            <div class="payment-option" onclick="showMethod('cod', this)">
                <i class="fa fa-money"></i> Cash on Delivery
            </div>
            <div class="payment-option" onclick="showMethod('emi', this)">
                <i class="fa fa-calendar"></i> EMI
            </div>
        </div>

        <div class="payment-content">
            
            <div id="upi" class="method-content active">
                <h4 style="margin-top: 0;">UPI</h4>
                <div class="radio-label">
                    <input type="radio" checked> Add new UPI ID
                    <span style="font-size: 12px; color: #2874f0; margin-left: auto; cursor: pointer;">How to find?</span>
                </div>
                
                <form method="POST" action="{% url 'payment_page' item_type item_id %}" onsubmit="showLoading()">
                    {% csrf_token %}
                    <div class="input-group">
                        <input type="text" class="upi-input" placeholder="Enter your UPI ID" required>
                        <button type="button" class="verify-btn">Verify</button>
                    </div>
                    <p style="font-size: 12px; color: #878787; margin-left: 25px; margin-top: 5px;">Securely pay using your UPI ID</p>

                    <button type="submit" class="pay-btn">PAY ₹{{ final_price }}</button>
                </form>
            </div>

            <div id="card" class="method-content">
                <h4 style="margin-top: 0;">Credit / Debit / ATM Card</h4>
                
                <form method="POST" action="{% url 'payment_page' item_type item_id %}" onsubmit="showLoading()">
                    {% csrf_token %}
                    <div class="input-group" style="margin-left: 0; flex-direction: column;">
                        <input type="text" class="upi-input" placeholder="Enter Card Number" required>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <input type="text" class="upi-input" placeholder="Valid Thru (MM/YY)" required>
                            <input type="password" class="upi-input" placeholder="CVV" required>
                        </div>
                    </div>
                    <button type="submit" class="pay-btn" style="margin-left: 0;">PAY ₹{{ final_price }}</button>
                </form>
            </div>

            <div id="netbanking" class="method-content">
                <h4>Net Banking</h4>
                <p>Select your Bank:</p>
                
                <form method="POST" action="{% url 'payment_page' item_type item_id %}" onsubmit="showLoading()">
                    {% csrf_token %}
                    <select class="upi-input" style="width: 100%;">
                        <option>HDFC Bank</option>
                        <option>SBI</option>
                        <option>ICICI Bank</option>
                        <option>Axis Bank</option>
                    </select>
                    <button type="submit" class="pay-btn" style="margin-left: 0;">PAY ₹{{ final_price }}</button>
                </form>
            </div>

            <div id="cod" class="method-content">
                <h4>Cash on Delivery</h4>
                <p>Pay safely with Cash or UPI at the time of delivery.</p>
                
                <form method="POST" action="{% url 'payment_page' item_type item_id %}" onsubmit="showLoading()">
                    {% csrf_token %}
                    <input type="hidden" name="payment_method" value="COD">
                    <button type="submit" class="pay-btn" style="margin-left: 0;">CONFIRM ORDER</button>
                </form>
            </div>

            <div id="emi" class="method-content">
                <h4>EMI (Easy Installments)</h4>
                <p>No EMI plans available currently.</p>
            </div>

        </div>
    </div>

    <div class="right-section">
        <div class="price-header">PRICE DETAILS</div>
        
        <div class="price-row">
            <span>Price</span>
            <span>₹{{ total_price }}</span>
        </div>
        <div class="price-row">
            <span>Delivery Charges</span>
            <span style="color: #388e3c;">FREE</span>
        </div>
        
        <div class="total-row price-row">
            <span>Total Amount</span>
            <span style="color: #2874f0;">₹{{ final_price }}</span>
        </div>

        <div class="savings-box">
            <i class="fa fa-tag"></i> You will save ₹{{ discount }} on this order
        </div>
        
        <div style="margin-top: 20px; font-size: 12px; color: #878787;">
            <i class="fa fa-shield"></i> Safe and Secure Payments. Easy returns. 100% Authentic products.
        </div>
    </div>
    
</div>

<div id="loading-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.9); z-index: 9999; flex-direction: column; align-items: center; justify-content: center;">
    <div class="spinner" style="border: 4px solid #f3f3f3; border-top: 4px solid #2874f0; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite;"></div>
    <h3 style="color: #2874f0; margin-top: 20px;">Processing Payment...</h3>
    <p style="color: #555;">Please do not close the window or press back.</p>
</div>

<script src="{% static "js/payment.js" %}"></script>
{% endblock %}